# دليل تطوير موديول المخازن الذكي
## خطة عملية للمبرمج - من الصفر للاحتراف

---

## 🎯 الفكرة الأساسية (اللي هنعملها)
بدل ما المخزن يبقى مجرد "دفتر" بنسجل فيه داخل وطالع، هنعمل مخزن **"ذكي"** يفهم:
- كل قطعة غيار مكونة من إيه
- كل قطعة موجودة فين بالظبط 
- امتى نطلب قطع جديدة قبل ما تخلص
- مين يقدر يعمل إيه في أي مخزن

---

## 📋 المراحل الثلاثة (ترتيب الشغل)

### 🔧 المرحلة الأولى: بناء الأساس
**الهدف:** نعمل "بطاقة شخصية" لكل قطعة غيار + نرسم المخازن على السيستم

### 📊 المرحلة الثانية: تسجيل الحركات اليومية  
**الهدف:** نسجل كل حاجة بتحصل في المخزن (داخل/طالع/منقول/متجمع/متفكك)

### 🤖 المرحلة الثالثة: الذكاء الاصطناعي
**الهدف:** السيستم يقولك "الصنف الفلاني قرب يخلص، اطلب منه دلوقتي"

---

## 📝 المرحلة الأولى - التفصيل الكامل

### الصفحة الأولى: "كتالوج الأصناف"
**مكانها:** صفحة جديدة في دوليبار  
**اسمها:** "كتالوج الأصناف الموحد"

#### شكل الصفحة:
```
┌─────────────────────────────────────────┐
│  🔍 بحث    │ ➕ إضافة صنف جديد          │
├─────────────────────────────────────────┤
│  📦 فئة الصنف    │ 🌍 بلد المنشأ        │
│  📸 صورة الصنف   │ 📋 نوع الصنف         │
│  📝 اسم الصنف    │ 🏷️ الكود المولد      │
│  📄 وصف تفصيلي   │ 💾 حفظ              │
└─────────────────────────────────────────┘
```

#### اللي بيحصل لما تضغط "إضافة صنف جديد":
1. **تختار فئة الصنف** من قائمة منسدلة:
   - مواتير كهربية (كود 4526)
   - مضخات (كود 4527) 
   - رولمان بلي (كود 4528)
   - مسامير (كود 4529)

2. **السيستم يولد الكود تلقائياً:**
   - لو اخترت "موتور كهربي" → هيبدأ بـ 4526
   - بعدين تختار بلد المنشأ: محلي (00) أو مستورد (01)
   - السيستم يكمل باقي الرقم لوحده → 4526-01-001-0001

3. **تملأ باقي البيانات:**
   - اسم الصنف: "موتور سير 10 حصان"
   - وصف: "موتور خاص بماكينة البثق رقم 5"
   - صورة واضحة للموتور
   - نوع الصنف: بسيط أم مركب

---

### صفحة تفاصيل الصنف (لما تدوس على أي صنف)
**مكانها:** صفحة منفصلة تفتح لما تدوس على صنف من الكتالوج

#### التابات اللي هتشوفها:

#### 🏷️ تاب "البيانات الأساسية"
```
┌─────────────────────────────────────────┐
│  الكود: 4526-01-001-0001                │
│  الاسم: موتور سير 10 حصان               │
│  الفئة: مواتير كهربية                   │
│  النوع: صنف مركب ✅                     │
│  بلد المنشأ: مستورد                     │
│  📸 صورة الموتور                        │
│  📝 الوصف: موتور خاص بماكينة البثق رقم 5 │
└─────────────────────────────────────────┘
```

#### 🏪 تاب "الموردين"
```
┌─────────────────────────────────────────┐
│  ➕ إضافة مورد جديد                     │
├─────────────────────────────────────────┤
│  شركة الأمل                             │
│  رقم القطعة عندهم: RB23                │
│  آخر سعر: 500 جنيه                      │
│  زمن التوريد: 15 يوم                    │
│  ────────────────────────────────────    │
│  شركة النور                             │
│  رقم القطعة عندهم: MTR-10HP             │
│  آخر سعر: 480 جنيه                      │
│  زمن التوريد: 20 يوم                    │
└─────────────────────────────────────────┘
```

#### 🔧 تاب "المكونات (BOM)" 
*(يظهر بس لو الصنف "مركب")*
```
┌─────────────────────────────────────────┐
│  ➕ إضافة مكون                          │
├─────────────────────────────────────────┤
│  🔩 رولمان بلي مقاس X                  │
│  الكمية المطلوبة: 2 قطعة                │
│  ────────────────────────────────────    │
│  ⚡ فرش كربونية                         │
│  الكمية المطلوبة: 4 قطع                 │
│  ────────────────────────────────────    │
│  🔌 مكثف                                │
│  الكمية المطلوبة: 1 قطعة                │
└─────────────────────────────────────────┘
```

#### 📍 تاب "الأرصدة في المخازن"
```
┌─────────────────────────────────────────┐
│  المخزن الرئيسي:        12 قطعة        │
│  مخزن خط الدهان:        3 قطع          │
│  مخزن خط البثق:         5 قطع          │
│  ────────────────────────────────────    │
│  إجمالي الرصيد:         20 قطعة        │
│  حد إعادة الطلب:        8 قطع          │
│  📊 عرض تاريخ الحركات                   │
└─────────────────────────────────────────┘
```

---

### الصفحة الثانية: "إعدادات المخازن"
**مكانها:** في قسم الإعدادات  
**الهدف:** نرسم المخازن زي ما هي في الحقيقة

#### شكل الصفحة:
```
┌─────────────────────────────────────────┐
│  ➕ إضافة مخزن جديد                     │
├─────────────────────────────────────────┤
│  🏭 المخزن الرئيسي (A)                 │
│    ├── 📦 حامل A                        │
│    │   ├── 🗄️ دولاب 1                   │
│    │   ├── 🗄️ دولاب 2                   │
│    │   │   ├── 📚 رف A                   │
│    │   │   ├── 📚 رف B                   │
│    │   │   ├── 📚 رف C                   │
│    │   │   └── 📚 رف D                   │
│    │   │       ├── 📦 صندوق 1          │
│    │   │       ├── 📦 صندوق 2          │
│    │   │       └── 📦 صندوق 3          │
│    │   └── 🗄️ دولاب 3                   │
│    └── 📦 حامل B                        │
├─────────────────────────────────────────┤
│  🎨 مخزن خط الدهان (B)                 │
│    └── 📦 حامل A                        │
└─────────────────────────────────────────┘
```

#### النتيجة:
- كل قطعة ليها عنوان دقيق زي: AA2D3
- A = المخزن، A = الحامل، 2 = الدولاب، D = الرف، 3 = الصندوق

---

### الصفحة الثالثة: "إدارة صلاحيات المستخدمين"
**مكانها:** في إعدادات المستخدمين

#### شكل الصفحة:
```
┌─────────────────────────────────────────┐
│  👤 المستخدم: أحمد محمد                │
│  💼 الوظيفة: أمين مخزن                 │
│  🏭 المخزن المخصص: مخزن خط الدهان      │
│  ──────────────────────────────────────  │
│  الصلاحيات:                            │
│  ✅ عرض أصناف مخزنه                    │
│  ✅ صرف من مخزنه                       │
│  ✅ استلام في مخزنه                     │
│  ❌ عرض باقي المخازن                   │
│  ❌ تعديل كتالوج الأصناف               │
└─────────────────────────────────────────┘
```

---

## 📊 المرحلة الثانية - تسجيل الحركات اليومية

### الصفحة الأولى: "استلام بضاعة"
**متى تستخدم:** لما يجي مورد يسلم بضاعة

#### شكل الصفحة:
```
┌─────────────────────────────────────────┐
│  📋 أمر الشراء: PO-2024-001            │
│  🏪 المورد: شركة الأمل                 │
│  📅 تاريخ الاستلام: 15/8/2024          │
│  ──────────────────────────────────────  │
│  الأصناف المطلوبة:                     │
│  ┌───────────────────────────────────┐   │
│  │ موتور سير 10 حصان               │   │
│  │ الكمية المطلوبة: 5               │   │
│  │ الكمية المستلمة: [4] ✏️         │   │
│  │ رقم القطعة من المورد: RB23      │   │
│  │ رقم اللوت: LOT-2024-08-15       │   │
│  │ تاريخ الصلاحية: 15/8/2027       │   │
│  │ السعر: 500 جنيه                  │   │
│  └───────────────────────────────────┘   │
│  💾 تأكيد الاستلام                      │
└─────────────────────────────────────────┘
```

#### اللي بيحصل لما تدوس "تأكيد الاستلام":
1. رصيد الموتور في المخزن يزيد بـ 4 قطع
2. السيستم يسجل رقم اللوت وتاريخ الصلاحية
3. السيستم يربط السعر بأمر الشراء

---

### الصفحة الثانية: "صرف لأمر شغل"
**متى تستخدم:** لما مهندس صيانة يطلب قطع غيار

#### شكل الصفحة:
```
┌─────────────────────────────────────────┐
│  🔧 أمر الشغل: WO-123                  │
│  👨‍🔧 طالب الصرف: مهندس أحمد            │
│  📅 تاريخ الطلب: 16/8/2024             │
│  ──────────────────────────────────────  │
│  🔍 ابحث عن الصنف: [موتور] 🔍         │
│  ┌───────────────────────────────────┐   │
│  │ موتور سير 10 حصان               │   │
│  │ الرصيد المتاح: 20 قطعة           │   │
│  │ الكمية المطلوبة: [1] ✏️          │   │
│  │ المكان: AA2D3                    │   │
│  │ السعر: 500 جنيه                  │   │
│  └───────────────────────────────────┘   │
│  💾 تأكيد الصرف                         │
└─────────────────────────────────────────┘
```

#### اللي بيحصل لما تدوس "تأكيد الصرف":
1. رصيد الموتور يقل من 20 لـ 19
2. تكلفة 500 جنيه تتسجل على أمر الشغل WO-123
3. السيستم يسجل مين صرف ومتى

---

### الصفحة الثالثة: "نقل بين المخازن"
**متى تستخدم:** لما تحتاج تنقل حاجة من مخزن لمخزن

#### شكل الصفحة:
```
┌─────────────────────────────────────────┐
│  🏭 من مخزن: الواحات                   │
│  🏭 إلى مخزن: القاهرة                  │
│  📅 تاريخ النقل: 17/8/2024             │
│  ──────────────────────────────────────  │
│  الأصناف المنقولة:                     │
│  ┌───────────────────────────────────┐   │
│  │ مسامير تثبيت 12 مم               │   │
│  │ الكمية: [100] ✏️                 │   │
│  │ الرصيد المتاح: 500 قطعة          │   │
│  └───────────────────────────────────┘   │
│  📤 إرسال طلب النقل                     │
└─────────────────────────────────────────┘
```

#### اللي بيحصل:
1. **في مخزن الواحات:** 100 قطعة تبقى "معلقة" (مش متاحة للصرف)
2. **في مخزن القاهرة:** يظهر إشعار "في انتظار استلام 100 قطعة"
3. لما أمين مخزن القاهرة يأكد الاستلام، العملية تتم

---

### الصفحة الرابعة: "التجميع والتفكيك" (الجديدة)
**متى تستخدم:** لما تجمع موتور من قطعه أو تفكك موتور تالف

#### شاشة التجميع:
```
┌─────────────────────────────────────────┐
│  🔧 نوع العملية: تجميع                 │
│  📦 الصنف المركب: موتور سير 10 حصان    │
│  🔢 عدد القطع المطلوب تجميعها: [3] ✏️  │
│  ──────────────────────────────────────  │
│  المكونات المطلوبة:                    │
│  ┌───────────────────────────────────┐   │
│  │ رولمان بلي: 6 قطع (3×2)         │   │
│  │ الرصيد المتاح: 50 ✅             │   │
│  │ فرش كربونية: 12 قطعة (3×4)      │   │
│  │ الرصيد المتاح: 30 ✅             │   │
│  └───────────────────────────────────┘   │
│  🔧 تنفيذ التجميع                       │
└─────────────────────────────────────────┘
```

#### اللي بيحصل لما تدوس "تنفيذ التجميع":
1. رصيد رولمان البلي يقل من 50 لـ 44
2. رصيد الفرش الكربونية يقل من 30 لـ 18  
3. رصيد الموتور الجاهز يزيد بـ 3 قطع

#### شاشة التفكيك:
```
┌─────────────────────────────────────────┐
│  🔧 نوع العملية: تفكيك                 │
│  📦 الصنف المركب: موتور سير 10 حصان    │
│  🔢 عدد القطع المطلوب تفكيكها: [1] ✏️  │
│  📝 سبب التفكيك: موتور تالف - إنقاذ قطع │
│  ──────────────────────────────────────  │
│  المكونات المسترجعة:                   │
│  ┌───────────────────────────────────┐   │
│  │ رولمان بلي: 2 قطعة               │   │
│  │ حالة القطع: مستعملة ✅            │   │
│  │ فرش كربونية: 4 قطع               │   │
│  │ حالة القطع: تالفة ❌              │   │
│  └───────────────────────────────────┘   │
│  🔧 تنفيذ التفكيك                       │
└─────────────────────────────────────────┘
```

---

### الصفحة الخامسة: "تحويل الحالة" (الجديدة)
**متى تستخدم:** لما تحول صنف من حالة لحالة (جديد → مستعمل → مُصلح)

#### شكل الصفحة:
```
┌─────────────────────────────────────────┐
│  📦 الصنف: لوح ألومنيوم 2×1 متر        │
│  📊 الحالة الحالية: جديد               │
│  🔄 الحالة الجديدة: قطع مقصوصة         │
│  🔢 الكمية: [1] لوح → [10] قطع ✏️     │
│  📝 سبب التحويل: تقطيع حسب المقاس      │
│  ──────────────────────────────────────  │
│  💰 إعادة التسعير مطلوبة؟ ✅            │
│  📧 إشعار القسم المالي ✅               │
│  ──────────────────────────────────────  │
│  🔄 تنفيذ التحويل                       │
└─────────────────────────────────────────┘
```

#### اللي بيحصل:
1. رصيد "لوح ألومنيوم جديد" يقل بـ 1
2. رصيد "قطع مقصوصة" يزيد بـ 10
3. السيستم يبعت إيميل للمالية عشان يسعروا القطع الجديدة

---

## 🤖 المرحلة الثالثة - الذكاء الاصطناعي

### الصفحة الأولى: "لوحة تحكم المخزون"
**مكانها:** الصفحة الرئيسية لما تفتح موديول المخازن

#### شكل الصفحة:
```
┌─────────────────────────────────────────┐
│  📊 إجمالي قيمة المخزون: 2,500,000 ج   │
│  📈 نسبة دوران المخزون: 4.2 مرة/سنة   │
│  ⚠️ أصناف تحتاج طلب شراء: 12 صنف      │
│  🚨 أصناف وصلت للحد الأدنى: 3 أصناف   │
│  ──────────────────────────────────────  │
│  📋 الأصناف الأكثر استهلاكاً:          │
│  ┌───────────────────────────────────┐   │
│  │ 1. مسامير تثبيت - 450 قطعة/شهر  │   │
│  │ 2. رولمان بلي - 23 قطعة/شهر     │   │
│  │ 3. فرش كربونية - 89 قطعة/شهر    │   │
│  └───────────────────────────────────┘   │
│  ──────────────────────────────────────  │
│  🔴 تحذيرات المخزون:                   │
│  • مسامير 8 مم: رصيد 45، الحد 50     │
│  • سلك كهرباء: رصيد 12 متر، الحد 20   │
└─────────────────────────────────────────┘
```

---

### الصفحة الثانية: "طلبات الشراء المقترحة"
**متى تظهر:** السيستم يشتغل لوحده كل يوم ويحلل الأرصدة

#### شكل الصفحة:
```
┌─────────────────────────────────────────┐
│  🤖 طلبات مقترحة من الذكاء الاصطناعي │
│  📅 تاريخ التحليل: 18/8/2024           │
│  ──────────────────────────────────────  │
│  ⚠️ عاجل - يحتاج طلب فوري:            │
│  ┌───────────────────────────────────┐   │
│  │ مسامير تثبيت 8 مم                │   │
│  │ الرصيد الحالي: 45 قطعة           │   │
│  │ الحد الأدنى: 50 قطعة             │   │
│  │ الكمية المقترحة: 200 قطعة        │   │
│  │ زمن التوريد: 7 أيام              │   │
│  │ 📋 إنشاء طلب شراء                │   │
│  └───────────────────────────────────┘   │
│  ──────────────────────────────────────  │
│  📊 متوقع خلال الشهر القادم:           │
│  ┌───────────────────────────────────┐   │
│  │ رولمان بلي مقاس X               │   │
│  │ الرصيد الحالي: 120 قطعة          │   │
│  │ الاستهلاك المتوقع: 25 قطعة       │   │
│  │ سيصل للحد الأدنى: 25/9/2024      │   │
│  │ 📅 تذكير بالطلب                  │   │
│  └───────────────────────────────────┘   │
└─────────────────────────────────────────┘
```

---

## 🔧 تفاصيل تقنية مهمة للمبرمج

### ربط الموديول بدوليبار:

#### 1. **جدول المنتجات الموجود:**
- هتضيف حقول جديدة لجدول `llx_product`:
  - `is_composite` (0 أو 1): هل الصنف مركب؟
  - `parent_machine` (نص): اسم الآلة الأب
  - `storage_location` (نص): مكان التخزين (AA2D3)
  - `reorder_point` (رقم): حد إعادة الطلب
  - `safety_stock` (رقم): مخزون الأمان

#### 2. **جداول جديدة تحتاج تعملها:**

**جدول `llx_product_suppliers`:**
```sql
- id (مفتاح أساسي)
- fk_product (ربط بالمنتج)
- supplier_name (اسم المورد)
- supplier_part_number (رقم القطعة عند المورد)
- lead_time_days (زمن التوريد بالأيام)
- last_price (آخر سعر شراء)
```

**جدول `llx_product_bom`:**
```sql
- id (مفتاح أساسي)  
- fk_parent_product (الصنف الأب)
- fk_child_product (الصنف الفرعي)
- quantity_needed (الكمية المطلوبة)
```

**جدول `llx_warehouse_locations`:**
```sql
- id (مفتاح أساسي)
- warehouse_code (رمز المخزن: A, B, C)
- location_code (رمز المكان: AA2D3)
- description (وصف المكان)
```

---

## 🎯 خطة التنفيذ (الترتيب اللي تشتغل بيه)

### الأسبوع الأول: الأساسيات
1. **اليوم 1-2:** صفحة "كتالوج الأصناف" + نظام التكويد التلقائي
2. **اليوم 3-4:** صفحة تفاصيل الصنف + تاب "البيانات الأساسية"
3. **اليوم 5:** تاب "الموردين" + إضافة/تعديل موردين

### الأسبوع الثاني: البنية المتقدمة  
1. **اليوم 1-2:** تاب "المكونات (BOM)" للأصناف المركبة
2. **اليوم 3-4:** صفحة "إعدادات المخازن" + رسم الهيكل
3. **اليوم 5:** نظام الصلاحيات + ربط المستخدمين بالمخازن

### الأسبوع الثالث: المعاملات الأساسية
1. **اليوم 1-2:** صفحة "استلام بضاعة" + ربطها بأوامر الشراء
2. **اليوم 3-4:** صفحة "صرف لأمر شغل" + ربطها بأوامر العمل  
3. **اليوم 5:** صفحة "نقل بين المخازن"

### الأسبوع الرابع: المعاملات المتقدمة
1. **اليوم 1-2:** صفحة "التجميع والتفكيك"
2. **اليوم 3-4:** صفحة "تحويل الحالة"
3. **اليوم 5:** اختبار شامل للمراحل 1 و 2

### الأسبوع الخامس: الذكاء ال